define(["require", "exports", "moment", "@process-engine/logging_api_contracts", "../serializer"], function (require, exports, moment, logging_api_contracts_1, Serializer) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    function parseProcessModelLog(logData) {
        const isV1 = logData[0] === 'ProcessModel';
        const isV2 = logData[0] === 'ProcessModel_V2';
        if (isV1) {
            return parseAsV1(logData);
        }
        if (isV2) {
            return parseAsV2(logData);
        }
        return undefined;
    }
    exports.parseProcessModelLog = parseProcessModelLog;
    function parseAsV1(logData) {
        const logEntry = new logging_api_contracts_1.LogEntry();
        logEntry.timeStamp = moment(logData[1]).toDate();
        logEntry.correlationId = logData[2];
        logEntry.processModelId = logData[3];
        logEntry.processInstanceId = logData[4];
        logEntry.logLevel = logging_api_contracts_1.LogLevel[logData[7]];
        logEntry.message = logData[8];
        return logEntry;
    }
    function parseAsV2(logData) {
        var _a, _b;
        const logEntry = new logging_api_contracts_1.LogEntry();
        logEntry.timeStamp = moment(logData[1]).toDate();
        logEntry.correlationId = logData[2];
        logEntry.processModelId = logData[3];
        logEntry.processInstanceId = logData[4];
        logEntry.logLevel = logging_api_contracts_1.LogLevel[logData[7]];
        logEntry.message = logData[8];
        logEntry.measuredAt = logData[9];
        const serializedError = (_a = logData[11]) === null || _a === void 0 ? void 0 : _a.trim();
        const deserializedError = ((_b = serializedError) === null || _b === void 0 ? void 0 : _b.length) > 1
            ? Serializer.deserialize(serializedError)
            : undefined;
        logEntry.error = deserializedError;
        return logEntry;
    }
});
//# sourceMappingURL=process_model_log_parser.js.map