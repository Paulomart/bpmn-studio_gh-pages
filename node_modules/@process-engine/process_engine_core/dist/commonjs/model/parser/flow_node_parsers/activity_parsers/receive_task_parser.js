"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const errors_ts_1 = require("@essential-projects/errors_ts");
const persistence_api_contracts_1 = require("@process-engine/persistence_api.contracts");
const type_factory_1 = require("../../../type_factory");
const activity_factory_1 = require("./activity_factory");
function parseReceiveTasks(processData, eventDefinitions) {
    const receiveTasksRaw = type_factory_1.getModelPropertyAsArray(processData, persistence_api_contracts_1.BpmnTags.TaskElement.ReceiveTask);
    const noReceiveTasksFound = !((receiveTasksRaw === null || receiveTasksRaw === void 0 ? void 0 : receiveTasksRaw.length) > 0);
    if (noReceiveTasksFound) {
        return [];
    }
    const receiveTasks = receiveTasksRaw.map((receiveTaskRaw) => {
        const receiveTask = activity_factory_1.createActivityInstance(receiveTaskRaw, persistence_api_contracts_1.Model.Activities.ReceiveTask);
        if (!receiveTaskRaw.messageRef) {
            throw new errors_ts_1.UnprocessableEntityError(`ReceiveTask ${receiveTaskRaw.id} does not have a messageRef!`);
        }
        receiveTask.messageEventDefinition = eventDefinitions.find((entry) => entry.id === receiveTaskRaw.messageRef);
        return receiveTask;
    });
    return receiveTasks;
}
exports.parseReceiveTasks = parseReceiveTasks;
//# sourceMappingURL=receive_task_parser.js.map